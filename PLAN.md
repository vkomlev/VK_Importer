# План внедрения VK Video Publisher

## Цель проекта
Публикация видео из экспорта Telegram Desktop (Windows) в VK Video с использованием Python и библиотеки python273/vk_api.

## Этапы разработки

### Этап 1: Структурирование проекта ✅
- [x] Создать структуру проекта
- [x] Инициализировать git репозиторий
- [x] Настроить виртуальную среду
- [x] Создать requirements.txt

### Этап 2: Парсинг экспорта Telegram
- [ ] Реализовать парсер HTML экспорта
  - [ ] Извлечение сообщений из HTML
  - [ ] Поиск прикрепленных видеофайлов
  - [ ] Сопоставление сообщений и файлов
- [ ] Реализовать парсер JSON экспорта
  - [ ] Парсинг структуры JSON
  - [ ] Извлечение метаданных сообщений
  - [ ] Поиск видеофайлов в структуре
- [ ] Создать общий интерфейс для парсеров
- [ ] Валидация существования файлов

### Этап 3: Формирование метаданных видео
- [ ] Создать систему заголовков (title generators)
  - [ ] Базовый генератор заголовков
  - [ ] Настраиваемые правила формирования
  - [ ] Регистрация и выбор генераторов
- [ ] Извлечение описания из текста сообщения
- [ ] Парсинг даты видео из сообщения
- [ ] Создание модели данных для видео

### Этап 4: Публикация в VK Video
- [ ] Настройка аутентификации VK API
- [ ] Реализация загрузки видео через VkUpload
- [ ] Обработка ошибок загрузки
- [ ] Логирование процесса публикации
- [ ] Поддержка повторных попыток при ошибках

### Этап 5: Интеграция и CLI
- [ ] Создать CLI интерфейс
- [ ] Конфигурационный файл
- [ ] Обработка множественных экспортов одного канала
- [ ] Прогресс-бар и отчеты

### Этап 6: Тестирование и документация
- [ ] Unit тесты для парсеров
- [ ] Unit тесты для генераторов заголовков
- [ ] Интеграционные тесты
- [ ] Документация по использованию
- [ ] Примеры конфигурации

## Структура проекта

```
VK_Importer/
├── src/
│   ├── __init__.py
│   ├── parsers/
│   │   ├── __init__.py
│   │   ├── base.py          # Базовый класс парсера
│   │   ├── html_parser.py   # Парсер HTML экспорта
│   │   └── json_parser.py   # Парсер JSON экспорта
│   ├── title_generators/
│   │   ├── __init__.py
│   │   ├── base.py          # Базовый класс генератора заголовков
│   │   └── generators.py    # Реализации генераторов
│   ├── models/
│   │   ├── __init__.py
│   │   └── video.py         # Модель данных видео
│   ├── publisher/
│   │   ├── __init__.py
│   │   └── vk_publisher.py   # Публикация в VK Video
│   └── utils/
│       ├── __init__.py
│       └── file_utils.py    # Утилиты для работы с файлами
├── config/
│   └── config.example.yaml  # Пример конфигурации
├── tests/
│   ├── __init__.py
│   ├── test_parsers.py
│   ├── test_title_generators.py
│   └── test_publisher.py
├── .gitignore
├── requirements.txt
├── README.md
└── main.py                  # Точка входа CLI
```

## Технические требования

### Зависимости
- Python 3.8+
- vk_api (python273/vk_api)
- BeautifulSoup4 (для парсинга HTML)
- PyYAML (для конфигурации)
- python-dateutil (для парсинга дат)

### Форматы экспорта Telegram
1. **HTML формат**: Сообщения в HTML файлах, видео в папке `files/`
2. **JSON формат**: Структурированные данные в JSON файлах

### Особенности
- Поддержка множественных экспортов одного канала
- Настраиваемые генераторы заголовков
- Валидация существования файлов перед публикацией
- Логирование всех операций
